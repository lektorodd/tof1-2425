---
title: "Niv친 2 - legge til knappstyring"
---

No skal me legga til ein knapp!

## Knappen skal

- Endre trafikklyset fr친 raudt til gr칮nt (eller omvendt) n친r den blir trykt
- Me bruker intern pullup-motstand i Arduino (de m친 finne ut kva dette er!)
- Det skal f칮lge normal trafikklys-sekvens ved endring (gult lys mellom)

## Me treng
- alt fr친 [steg 1](ard1.qmd)
- 1 knapp med leidningar

## Kopling
Knappen skal koplast til pin 5 og jord

---

### 游댍 F칮r de programmerer

- Kva er ein pullup-motstand?
- Kvifor treng me pullup-motstand med knappar?
- Kva betyr "intern pullup"?
- Kva skjer viss me ikkje bruker pullup?

### 游 Sj친 p친 koden i boksen under

::: {.callout-note collapse="true"}
## Koden

```cpp
// Led-pins er som f칮r
const int raudLys = 2;
const int gulLys = 3;
const int gronLys = 4;
const int knappPin = 5;     // Pin for knappen

// Variabel for 친 hugse tilstanden til lyset
bool erRaudt = true;        // true = raudt lys, false = gr칮nt lys

void setup() {
  // Set opp LED-pins som f칮r
  pinMode(raudLys, OUTPUT);
  pinMode(gulLys, OUTPUT);
  pinMode(gronLys, OUTPUT);
  
  // Set opp knappen med intern pullup
  pinMode(knappPin, INPUT_PULLUP);
  
  // Start med raudt lys
  digitalWrite(raudLys, HIGH);
  digitalWrite(gulLys, LOW);
  digitalWrite(gronLys, LOW);
}

void loop() {
  // Les av knappen (LOW = trykt, pga pullup)
  if (digitalRead(knappPin) == LOW) {
    if (erRaudt) {
      // Viss lyset er raudt, bytt til gr칮nt
      skiftTilGront();
    } else {
      // Viss lyset er gr칮nt, bytt til raudt
      skiftTilRaudt();
    }
    delay(500);  // Enkel "debounce" - unng친 fleire knappetrykk
  }
}

// Funksjon for 친 skifte til gr칮nt lys
void skiftTilGront() {
  digitalWrite(gulLys, HIGH);    // Raudt + gult
  delay(1000);
  digitalWrite(raudLys, LOW);     // Skru av raudt
  digitalWrite(gulLys, LOW);     // Skru av gult
  digitalWrite(gronLys, HIGH);  // Skru p친 gr칮nt
  erRaudt = false;              // Hugs at me no har gr칮nt lys
}

// Funksjon for 친 skifte til raudt lys
void skiftTilRaudt() {
  digitalWrite(gronLys, LOW);   // Skru av gr칮nt
  digitalWrite(gulLys, HIGH);    // Skru p친 gult
  delay(1000);
  digitalWrite(gulLys, LOW);     // Skru av gult
  digitalWrite(raudLys, HIGH);    // Skru p친 raudt
  erRaudt = true;               // Hugs at me no har raudt lys
}
```
:::

- Kva gjer variabelen `erRaudt`?
- Kvifor er knappen `LOW` n친r den er trykt?
- Kva er `delay(500)` til?

### 游눩 Utfordring

Kan du f친 knappen til 친 virke berre n친r lyset har vore same farge i minst 5 sekund?

**Hint:** Du m친 bruke `millis()` for 친 m친le tid